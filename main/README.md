Here is the full code.
